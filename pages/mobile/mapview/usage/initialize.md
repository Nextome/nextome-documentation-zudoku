# Initialize

In this section you can find the steps to correctly inizialize the Nextome MapView. 
For Android is mandatory to add the relative layout element while for iOS, the view controller will be autogenerated by the Nextome MapView SDK.

## Initialization of the Nextome MapView

The step below is for Android only. 

:::note{title="Android layout element"}
    If you are working with Android first add this on your activity.xml file
    ```
        <com.nextome.nextomemapview.NextomeMapView
            android:id="@+id/mapview"
            android:forceHasOverlappingRendering="true"
            android:layout_width="match_parent"
            android:layout_height="match_parent" />
    ```
:::

:::warning{title="Jetpack Compose not supported yet!"}
    Jetpack Compose is not supported. If your goal is to use Nextome Map View inside a Jetpack Compose application, you need to use Views inside Compose. Follow [this](https://developer.android.com/develop/ui/compose/migrate/interoperability-apis/views-in-compose#:~:text=InteroperabilityAPIsSnippets.kt-,Fragments%20in%20Compose,the%20holder%20for%20your%20Fragment%20.) to learn more abount that.
:::

<br/>

The code to use for Android and iOS.

<MultilangCodeTab content={
[
  {
    language: "kotlin",
    code: `// Declare the NextomeMapViewHandler
// You can declare it at start of your MainActivity scope
val mapview: NextomeMapViewHandler = NextomeMapViewHandler()
...
// Initialize the mapview handler
mapview.initialize(
    fragmentManager = supportFragmentManager,
    viewId = R.id.mapview, 
    this
)

// Create the first tile
var tile: NMTile = NMTile()
tile.show = true
tile.name = "Tile1"
tile.id = "1234"
tile.source = "PATH TO THE .ZIP"

// Set the resource to show on map
mapview.setResources(tiles = listOf(tile), zoom = 1, width = 2000, height = 1000)`
  },
  {
    language: "swift",
    code: `// Import the module
import NextomeMapView

// Call initialize(), usually in the viewDidLoad of your controller
NextomeMapViewHandler.instance.initialize(onReady: {

    var vc = NextomeMapViewHandler.instance.initializeFlutterViewController()
    self.present(vc, animated: true)

    // Create tiles and set resources here
    var tile: NMTile = NMTile(name: "Tile1", id: "1234", source: "PATH TO THE .ZIP")
    NextomeMapViewHandler.instance.setResources(tiles: [tile], zoom: 1, width: 2000, height: 1000)
})

// Subscribe to listeners
NextomeMapViewHandler.instance.setOnMapReady(callback: yourMapReadyMethod)
NextomeMapViewHandler.instance.setOnMapTap(callback: yourMapTapMethod)
NextomeMapViewHandler.instance.setOnMapLongPress(callback: yourMapLongPressMethod)
NextomeMapViewHandler.instance.setOnMarkerTap(callback: yourMarkerTapMethod)`
  }
]
}/>

:::note
    The Tile declaration and the call of `setResources` method is mandatory to load and show elements on MapView. Without a background resource like a Tile, the map can't be fully initialized.
    You can define multiple tiles map and pass them into a list int setResources method. 
    We discourage setResources after the map has built becouse the plugin need to elaborate the zip file, so if you can, pass all you need tiles once at when you start to use the MapView. 
    To avoid strange behaviour, the different tiles need to have same width and height.
:::

## Android only

To ensure proper integration and behavior of the plugin within your Android application, we recommend overriding the following lifecycle and system callback methods in your Activity or Fragment as needed.


<CustomCodeBlock 
language="kotlin"
code={`  override fun onPostResume() {
        super.onPostResume()
        mapview.onPostResume()
        window.decorView.systemUiVisibility = View.SYSTEM_UI_FLAG_VISIBLE
    }

    override fun onNewIntent(intent: Intent?) {
        super.onNewIntent(intent)
        intent?.let { mapview.onNewIntent(it) }
    }

    @Deprecated("Deprecated in Java")
    override fun onBackPressed() {
        super.onBackPressed()
        mapview.onBackPressed()
        moveTaskToBack(true)
    }

    override fun onRequestPermissionsResult(
        requestCode: Int,
        permissions: Array<out String>,
        grantResults: IntArray
    ) {
        super.onRequestPermissionsResult(requestCode, permissions, grantResults)
        mapview.onRequestPermissionsResult(requestCode, permissions, grantResults)
    }

    override fun onActivityResult(
        requestCode: Int,
        resultCode: Int,
        data: Intent?
    ) {
        super.onActivityResult(requestCode, resultCode, data)
        mapview.onActivityResult(resultCode, resultCode, data)
    }

    override fun onUserLeaveHint() {
        mapview.onUserLeaveHint()
    }

    override fun onTrimMemory(level: Int) {
        super.onTrimMemory(level)
        mapview.onTrimMemory(level)
    }`
}/>